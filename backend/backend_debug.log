
> backend@0.0.1 start:dev
> nest start --watch

[2J[3J[H[[90m12:01:33[0m] Starting compilation in watch mode...

[[90m12:01:38[0m] Found 0 errors. Watching for file changes.

[32m[Nest] 14392  - [39m03/02/2026, 12:01:40 [32m    LOG[39m [38;5;3m[NestFactory] [39m[32mStarting Nest application...[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mPrismaModule dependencies initialized[39m[38;5;3m +57ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mAppModule dependencies initialized[39m[38;5;3m +35ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mTranscriptionModule dependencies initialized[39m[38;5;3m +1ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mAnalysisModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mExportModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[InstanceLoader] [39m[32mAudioModule dependencies initialized[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RoutesResolver] [39m[32mAppController {/}:[39m[38;5;3m +62ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/, GET} route[39m[38;5;3m +3ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RoutesResolver] [39m[32mAudioController {/audio}:[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/audio/upload, POST} route[39m[38;5;3m +1ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/audio/:id, GET} route[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RoutesResolver] [39m[32mTranscriptionController {/transcription}:[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/transcription/:audioId, POST} route[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/transcription/:audioId, GET} route[39m[38;5;3m +1ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RoutesResolver] [39m[32mAnalysisController {/analysis}:[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/analysis/:audioId, POST} route[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/analysis/:audioId, GET} route[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RoutesResolver] [39m[32mExportController {/export}:[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/export/:audioId/:format, POST} route[39m[38;5;3m +1ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/export/:exportId, GET} route[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[RouterExplorer] [39m[32mMapped {/export/audio/:audioId, GET} route[39m[38;5;3m +0ms[39m
[32m[Nest] 14392  - [39m03/02/2026, 12:01:41 [32m    LOG[39m [38;5;3m[NestApplication] [39m[32mNest application successfully started[39m[38;5;3m +35ms[39m
[AudioController] POST /upload received. userId: user123
[AudioService] Starting upload process for userId: user123
[AudioService] File metadata: {
  originalname: 'test1.m4a',
  mimetype: 'audio/mp4',
  size: 73046366,
  path: 'uploads\\1770130961444-958390999-test1.m4a'
}
[AudioService] Attempting to upload to Dropbox at: /audios/1770130983001-test1.m4a
[AudioService] Successfully read local file (async): uploads\1770130961444-958390999-test1.m4a
[AudioService] Dropbox upload failed. Error details: {
  "name": "DropboxResponseError",
  "status": 401,
  "headers": {},
  "error": {
    "error_summary": "expired_access_token/...",
    "error": {
      ".tag": "expired_access_token"
    }
  }
}
[AudioService] FATAL ERROR during uploadAudio: DropboxResponseError: Response failed with a 401 code
    at C:\Users\PC Blado\Desktop\AIDO\3-Proyectos\Grabadora_IA\backend\node_modules\dropbox\cjs\src\response.js:34:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async AudioService.uploadAudio (C:\Users\PC Blado\Desktop\AIDO\3-Proyectos\Grabadora_IA\backend\src\audio\audio.service.ts:55:26) {
  status: 401,
  headers: Headers {
    [Symbol(map)]: [Object: null prototype] {
      'content-type': [Array],
      'cache-control': [Array],
      'content-security-policy': [Array],
      'www-authenticate': [Array],
      'x-content-type-options': [Array],
      date: [Array],
      server: [Array],
      'content-length': [Array],
      'strict-transport-security': [Array],
      'x-robots-tag': [Array],
      'x-dropbox-response-origin': [Array],
      'x-dropbox-request-id': [Array]
    }
  },
  error: {
    error_summary: 'expired_access_token/...',
    error: { '.tag': 'expired_access_token' }
  }
}
[Nest] 14392  - 03/02/2026, 12:03:16   ERROR [ExceptionsHandler] DropboxResponseError: Response failed with a 401 code
    at C:\Users\PC Blado\Desktop\AIDO\3-Proyectos\Grabadora_IA\backend\node_modules\dropbox\cjs\src\response.js:34:11
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async AudioService.uploadAudio (C:\Users\PC Blado\Desktop\AIDO\3-Proyectos\Grabadora_IA\backend\src\audio\audio.service.ts:55:26) {
  status: 401,
  headers: Headers {
    [Symbol(map)]: [Object: null prototype] {
      'content-type': [
        'application/json'
      ],
      'cache-control': [
        'no-cache'
      ],
      'content-security-policy': [
        'sandbox allow-forms allow-scripts'
      ],
      'www-authenticate': [
        'Bearer realm="Dropbox-API"'
      ],
      'x-content-type-options': [
        'nosniff'
      ],
      date: [
        'Tue, 03 Feb 2026 15:03:18 GMT'
      ],
      server: [
        'envoy'
      ],
      'content-length': [
        '88'
      ],
      'strict-transport-security': [
        'max-age=31536000; includeSubDomains; preload'
      ],
      'x-robots-tag': [
        'noindex, nofollow, noimageindex'
      ],
      'x-dropbox-response-origin': [
        'far_remote'
      ],
      'x-dropbox-request-id': [
        '072fa09dd7c54915b896493969820e29'
      ]
    }
  },
  error: {
    error_summary: 'expired_access_token/...',
    error: {
      '.tag': 'expired_access_token'
    }
  }
}
